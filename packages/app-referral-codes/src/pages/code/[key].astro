---
import CodeCard from '@/components/CodeCard.vue'
import Layout from '@/layouts/Layout.astro'

import { brands, codes } from '@/data/codes'

export function getStaticPaths() {
  return codes.map((code) => ({ params: code }))
}

type Params = Awaited<ReturnType<typeof getStaticPaths>>[number]['params']
const { key } = Astro.params as unknown as Params

const code = codes.find((code) => code.key === key)!
const brand = brands.find((brand) => brand.key === code?.brandKey)!

export const prerender = true
---

<Layout>
  <Fragment slot="head"></Fragment>

  <Fragment slot="body">
    <div
      class="flex flex-col justify-center items-center h-full max-w-xl m-auto"
    >
      <h1 class="text-3xl font-semibold mb-10">{brand.name} Referral Code</h1>

      <section id="code" class="h-auto sm:h-[540px] w-full">
        <CodeCard client:only codeKey={key} direct />
      </section>
    </div>
  </Fragment>
</Layout>
